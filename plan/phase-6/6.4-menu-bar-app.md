# 6.4 Menu Bar App

**Objective:** Optional menu bar mode for quick access without full window.

## Implementation

### Menu Bar Controller

Create `Services/MenuBarController.swift`:

```swift
import AppKit
import SwiftUI

class MenuBarController: ObservableObject {
    private var statusItem: NSStatusItem?

    func install() {
        statusItem = NSStatusBar.system.statusItem(withLength: NSStatusItem.variableLength)

        if let button = statusItem?.button {
            button.image = NSImage(systemSymbolName: "shield.fill", accessibilityDescription: "FocusDragon")
            button.action = #selector(statusItemClicked)
            button.target = self
        }

        updateIcon()
    }

    func updateIcon() {
        guard let button = statusItem?.button else { return }

        let isBlocking = BlockListManager.shared.isBlocking

        button.image = NSImage(
            systemSymbolName: isBlocking ? "shield.fill" : "shield",
            accessibilityDescription: "FocusDragon"
        )
    }

    @objc private func statusItemClicked() {
        showMenu()
    }

    private func showMenu() {
        let menu = NSMenu()

        let statusItem = NSMenuItem(
            title: BlockListManager.shared.isBlocking ? "Blocking Active" : "Inactive",
            action: nil,
            keyEquivalent: ""
        )
        menu.addItem(statusItem)

        menu.addItem(NSMenuItem.separator())

        let toggleItem = NSMenuItem(
            title: BlockListManager.shared.isBlocking ? "Stop Blocking" : "Start Blocking",
            action: #selector(toggleBlocking),
            keyEquivalent: "b"
        )
        toggleItem.target = self
        menu.addItem(toggleItem)

        menu.addItem(NSMenuItem.separator())

        let showItem = NSMenuItem(title: "Show Window", action: #selector(showWindow), keyEquivalent: "")
        showItem.target = self
        menu.addItem(showItem)

        let quitItem = NSMenuItem(title: "Quit", action: #selector(NSApplication.terminate(_:)), keyEquivalent: "q")
        menu.addItem(quitItem)

        statusItem?.menu = menu
        statusItem?.button?.performClick(nil)
        statusItem?.menu = nil
    }

    @objc private func toggleBlocking() {
        // Toggle blocking
    }

    @objc private func showWindow() {
        NSApp.activate(ignoringOtherApps: true)
    }
}
```

## Testing

✅ Icon appears in menu bar
✅ Menu opens on click
✅ Toggle works
✅ Show window works

## Estimated Time

**2 hours**
